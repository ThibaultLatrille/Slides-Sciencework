A<-c(48,36,20,29,42,42,20,42,22,41,45,14,6,0,33,28,34,4,32,24,47,41,24,26,30,41)
A<-A-mean(A)
B<-c(42,33,16,39,38,36,15,33,20,43,34,22,7,15,34,29,41,13,38,25,27,41,28,14,28,40)
B<-B-mean(B)
options(digits=5)
model1<-lm(A~B)
plot(B,A)
abline(coef(model1))
model2<-lm(B~A)
abline(0,1/coef(model2)[2],col=2)
coef(model2)[2]
coef(model1)[2]
library(MethComp)
model3=Deming(B,A)
abline(0,model3[2],col=3)
b4=tan((atan(1/coef(model2)[2])+atan(coef(model1)[2]))/2)
abline(0,b4,col=4)

b5=SIMEX(A,B)
abline(0,b5,col=13)
legend(locator(n=1),legend=c("A~B","B~A","TLS","Bissectrice","SIMEX"),lwd=2,col=c(1,2,3,4,13))
legend(locator(n=1),legend=c(format(coef(model1)[2],5),format(1/coef(model2)[2],5),format(model3[2],5),format(b4,5),format(b5,5)),lwd=2,col=c(1,2,3,4,13))