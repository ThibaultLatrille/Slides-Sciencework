# TODO: Add comment
# 
# Author: Thibault
###############################################################################


TS<-ts(c(1.1959737, -1.5462655, -3.2074894,  1.1201099,  2.7664945,  1.7280464,
		0.4748675,  0.3225717, -0.1150240,  2.2213247,  0.6528709,  1.6223956,
		3.3975704, -2.1830910, -4.2630464, -3.0339021,  0.7292003,  1.4023737,
		0.0343180, -0.1117035, -2.6109930, -2.6923939,  0.7360647,  1.1169648,
		0.9844019, -1.8802091, -0.9705676, -1.8361953,  0.5561025,  1.5524120,
		3.7656146,  0.9894278, -2.0700342, -1.3822353, -1.1966014,  0.4913922,
		1.4723081, -2.5769717, -2.4732192, -0.6528095, -1.7652368,  1.1819837,
		0.4025664, -0.3306871,  0.3982025,  3.3900164,  4.0774918,  5.6202259,
		2.3164217, -3.7468379, -3.0892611, -1.7321010, -1.2588312,  1.755483,
		0.4080225, -0.7460235, -1.5315005,  0.4678402, -0.8810457,  2.1099209,
		-0.9069835, -2.6409398, -0.5375984, -3.0990756,  0.5094836,  3.2427906,
		1.9159999, -0.8782267, -2.7772637, -3.0587087,  1.0650833,  0.7742680,
		1.4428541, -0.2417131, -1.6891479, -0.9568912,  0.7796219,  3.5554492,
		-0.2353330, -2.2522144, -1.6890698, -0.4225651,  2.1030431,  4.3432196,
		2.2828699, -1.9610531, -3.0236832, -2.0156912, -0.2637920,  1.9909414,
		2.3143867, -1.7145064, -3.3234655, -0.9998362 , 1.9511601,  2.476046,
		-0.2236457, -0.3336876, -0.9703204, -0.8002343))
bandwidth<-c(2,3,4,5,10,15)
f<-as.numeric(spec$freq)
s<-as.numeric(spec$spec)
plot(f,s,"l",lwd=2,main="Estimation of the spectral density",xlab="frequency",ylab="spectrum")
col=2
for (i in bandwidth){
	print(i)
	spec1<-spectrum(TS,span=c(i,i),plot=FALSE)
	f1<-as.numeric(spec1$freq)
	s1<-as.numeric(spec1$spec)
	lines(f1,s1,col=col,lwd=2)
	col<-col+1
}
spec<-spectrum(TS,plot=FALSE)
rank<-as.numeric(which.max(spec$spec))
max<-as.numeric(spec$freq[rank])
abline(v=max,lwd=3,lty="dotted")
cpgram(TS)